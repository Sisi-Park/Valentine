<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Better ‚Äúreal typewriter‚Äù font (ink + slight imperfections) -->
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&family=IM+Fell+English+SC&family=Special+Elite&display=swap" rel="stylesheet">

<title>Will you be my Valentine?</title>

<style>
  body{
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;
    background:linear-gradient(135deg,#ffafbd,#ffc3a0);
    font-family:'Quicksand',sans-serif;
  }

  .card{
    width:min(640px,92vw);
    background:rgba(255,255,255,0.97);
    border-radius:30px;
    padding:44px 30px 40px;
    box-shadow:0 35px 95px rgba(0,0,0,0.25);
    text-align:center;
    overflow:hidden;
  }

  h1{
    margin:0 0 30px;
    font-size:34px;
    font-weight:600;
    color:#ff3e6c;
    letter-spacing:0.2px;
  }

  .letter-wrap{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:26px;
    margin-bottom:30px;
    perspective:1200px;
  }

  /* ---------- REALISTIC ENVELOPE (3D + folds + shadows) ---------- */
  .envelope{
    width:320px;
    height:220px;
    position:relative;
    border:none;
    background:transparent;
    cursor:pointer;
    transform-style:preserve-3d;
    transition:transform .35s ease;
    -webkit-tap-highlight-color:transparent;
  }
  .envelope:hover{ transform: rotateX(10deg) rotateZ(-0.8deg); }

  .env-base{
    position:absolute;
    inset:0;
    border-radius:12px;
    background:
      radial-gradient(120px 60px at 18% 30%, rgba(0,0,0,0.06), transparent 60%),
      radial-gradient(140px 70px at 82% 40%, rgba(0,0,0,0.05), transparent 62%),
      linear-gradient(180deg, #fffdf8, #f2ebdf);
    box-shadow:
      0 26px 70px rgba(0,0,0,0.28),
      inset 0 1px 0 rgba(255,255,255,0.8),
      inset 0 -10px 18px rgba(0,0,0,0.06);
    overflow:hidden;
  }

  /* subtle paper grain */
  .env-base::after{
    content:"";
    position:absolute;
    inset:0;
    background:
      repeating-linear-gradient(0deg, rgba(0,0,0,0.02) 0 1px, transparent 1px 3px),
      repeating-linear-gradient(90deg, rgba(0,0,0,0.015) 0 1px, transparent 1px 4px);
    opacity:0.25;
    mix-blend-mode:multiply;
    pointer-events:none;
  }

  /* left & right folds */
  .env-left, .env-right, .env-bottom{
    position:absolute;
    inset:0;
    border-radius:12px;
    pointer-events:none;
  }

  .env-left{
    clip-path: polygon(0 0, 52% 50%, 0 100%);
    background: linear-gradient(135deg, rgba(0,0,0,0.06), rgba(255,255,255,0.0) 65%);
  }

  .env-right{
    clip-path: polygon(100% 0, 48% 50%, 100% 100%);
    background: linear-gradient(225deg, rgba(0,0,0,0.06), rgba(255,255,255,0.0) 65%);
  }

  .env-bottom{
    clip-path: polygon(0 100%, 50% 52%, 100% 100%);
    background: linear-gradient(0deg, rgba(0,0,0,0.09), rgba(255,255,255,0.0) 70%);
    opacity:0.9;
  }

  /* top flap */
  .env-flap{
    position:absolute;
    inset:0;
    border-radius:12px;
    clip-path: polygon(0 0, 100% 0, 50% 58%);
    background:
      radial-gradient(140px 70px at 50% 12%, rgba(255,255,255,0.6), transparent 60%),
      linear-gradient(180deg, #f7f0e6, #e6dccd);
    transform-origin: top center;
    transform: rotateX(0deg);
    transition: transform 880ms cubic-bezier(.25,.85,.2,1);
    box-shadow: 0 10px 16px rgba(0,0,0,0.10);
  }

  /* inner shadow when flap is closed */
  .env-inner-shadow{
    position:absolute;
    left:0; right:0; top:0;
    height:72%;
    border-radius:12px;
    box-shadow: inset 0 -22px 26px rgba(0,0,0,0.12);
    opacity:0.5;
    pointer-events:none;
  }

  .envelope.open .env-flap{
    transform: rotateX(-165deg);
  }
  .envelope.open .env-inner-shadow{
    opacity:0.0;
    transition: opacity 300ms ease;
  }

  .env-seal{
    position:absolute;
    left:50%;
    top:56%;
    transform:translate(-50%,-50%);
    width:48px;
    height:48px;
    border-radius:999px;
    background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.55), rgba(255,255,255,0.05) 55%),
                linear-gradient(180deg, rgba(255,80,120,0.30), rgba(255,80,120,0.18));
    box-shadow: 0 10px 22px rgba(0,0,0,0.18);
    display:grid;
    place-items:center;
    font-size:22px;
    pointer-events:none;
  }

  /* ---------- LETTER (paper + typewriter ink) ---------- */
  .letter{
    width:min(560px,92vw);
    background: linear-gradient(180deg, #fffdf8, #f6efe3);
    border-radius:12px;
    padding:30px;
    box-shadow:
      0 18px 45px rgba(0,0,0,0.22),
      inset 0 0 18px rgba(0,0,0,0.05);
    opacity:0;
    max-height:0;
    overflow:hidden;
    transition:opacity .55s ease, max-height .85s ease;

    text-align:left;
  }
  .letter.show{ opacity:1; max-height:720px; }

  /* ‚Äúmore real‚Äù typewriter feel */
  .typed{
    font-family:'Special Elite', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size:21px;
    line-height:1.75;
    color:#1f1f1f;
    letter-spacing:0.2px;
    white-space:pre-wrap;
    word-break:break-word;

    /* ink texture */
    text-shadow: 0.35px 0.35px 0 rgba(0,0,0,0.12);
    filter: contrast(1.03);
  }

  /* subtle uneven ink per line look */
  .typed span{
    display:inline-block;
    transform: translateY(var(--jitterY));
    opacity: var(--ink);
  }

  .cursor{
    display:inline-block;
    width:10px;
    margin-left:3px;
    animation:blink 1s steps(1) infinite;
  }
  @keyframes blink{ 50%{opacity:0;} }

  /* Hearts burst */
  .pop-heart{
    position:absolute;
    left:50%;
    top:34px;
    transform:translateX(-50%);
    animation:pop 1s ease forwards;
    pointer-events:none;
    filter: drop-shadow(0 6px 12px rgba(0,0,0,0.18));
  }
  @keyframes pop{
    0%{opacity:0;transform:translate(-50%,0) scale(.6);}
    20%{opacity:1;}
    100%{opacity:0;transform:translate(calc(-50% + var(--dx)),var(--dy)) scale(1.35);}
  }

  .btns{
    display:flex;
    justify-content:center;
    gap:20px;
    margin-top:30px;
  }
  button.action{
    border:none;
    border-radius:999px;
    padding:15px 28px;
    font-size:18px;
    cursor:pointer;
    font-family:'Quicksand',sans-serif;
    transition:transform .3s ease;
  }
  #yes{ background:#ff4d79; color:#fff; }
  #no{ background:#f0f0f0; color:#333; position:relative; }

</style>
</head>

<body>
  <div class="card">
    <h1 id="headline">Will you be my Valentine?</h1>

    <div class="letter-wrap">
      <button class="envelope" id="openLetter" type="button" aria-label="Open letter">
        <div class="env-base"></div>
        <div class="env-left"></div>
        <div class="env-right"></div>
        <div class="env-bottom"></div>
        <div class="env-inner-shadow"></div>
        <div class="env-flap"></div>
        <div class="env-seal">üíå</div>
      </button>

      <div class="letter" id="letter">
        <div class="typed" id="typed"></div><span class="cursor" id="cursor">|</span>
      </div>
    </div>

    <div class="btns">
      <button class="action" id="yes">Yes üíò</button>
      <button class="action" id="no">No</button>
    </div>
  </div>

<script>
  const params = new URLSearchParams(location.search);
  const name = params.get("name");
  if (name) document.getElementById("headline").textContent = `${name}, will you be my Valentine?`;

  const FULL_TEXT =
`Nick,

Thank you for showing me a kind of love I didn't know was possible.

Will you be my Valentine?`;

  const openBtn = document.getElementById("openLetter");
  const letterEl = document.getElementById("letter");
  const typedEl = document.getElementById("typed");
  const cursorEl = document.getElementById("cursor");

  let opened = false;
  let typing = false;

  function burstHearts(){
    const hearts=["üíñ","üíò","üíï","‚ù§Ô∏è"];
    for(let i=0;i<16;i++){
      const h=document.createElement("div");
      h.className="pop-heart";
      h.textContent=hearts[Math.floor(Math.random()*hearts.length)];
      h.style.setProperty("--dx",(Math.random()*260-130)+"px");
      h.style.setProperty("--dy",(-Math.random()*220-80)+"px");
      h.style.fontSize = (16 + Math.random()*16).toFixed(0) + "px";
      openBtn.appendChild(h);
      setTimeout(()=>h.remove(),1000);
    }
  }

  // more ‚Äúreal‚Äù typewriter animation:
  // - variable speed per character
  // - small per-character jitter
  // - slightly uneven ink opacity
  function typeText(text){
    if(typing) return;
    typing = true;
    typedEl.innerHTML = "";
    cursorEl.style.display = "inline-block";

    let i = 0;

    const tick = () => {
      const ch = text[i];

      const span = document.createElement("span");
      span.textContent = ch;

      // subtle imperfections
      const jitterY = (Math.random()*0.8 - 0.4).toFixed(2) + "px";
      const ink = (0.86 + Math.random()*0.14).toFixed(2);
      span.style.setProperty("--jitterY", jitterY);
      span.style.setProperty("--ink", ink);

      typedEl.appendChild(span);

      i++;
      if(i >= text.length){
        typing = false;
        setTimeout(()=>{ cursorEl.style.display="none"; }, 900);
        return;
      }

      // variable timing: pauses on punctuation/newline
      let delay = 22 + Math.random()*38;
      if(ch === "\n") delay = 140 + Math.random()*140;
      if([",",".","!","?"].includes(ch)) delay = 120 + Math.random()*140;

      setTimeout(tick, delay);
    };

    tick();
  }

  openBtn.addEventListener("click", () => {
    if(opened) return;
    opened = true;

    openBtn.classList.add("open");
    letterEl.classList.add("show");
    burstHearts();

    setTimeout(()=> typeText(FULL_TEXT), 320);
  });

  const noBtn = document.getElementById("no");
  const yesBtn = document.getElementById("yes");
  let count = 0;

  function moveNo(){
    count++;
    yesBtn.style.transform = `scale(${1 + count*0.15})`;
    noBtn.style.transform  = `scale(${Math.max(0.3, 1 - count*0.12)})`;
    const x = Math.random()*200 - 100;
    const y = Math.random()*120 - 60;
    noBtn.style.position = "relative";
    noBtn.style.left = x+"px";
    noBtn.style.top  = y+"px";
  }

  noBtn.addEventListener("mouseenter", moveNo);
  noBtn.addEventListener("touchstart", moveNo, {passive:true});

  yesBtn.addEventListener("click", () => {
    const q = name ? `?name=${encodeURIComponent(name)}` : "";
    window.location.href = `yes.html${q}`;
  });
</script>
</body>
</html>
